<?xml version="1.0" encoding="utf-8"?>
<AxForm xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="Microsoft.Dynamics.AX.Metadata.V6">
	<Name>ProjSalesPriceCost</Name>
	<SourceCode>
		<Methods xmlns="">
			<Method>
				<Name>classDeclaration</Name>
				<Source><![CDATA[
[Form]
    public class ProjSalesPriceCost extends FormRun
    {
        QueryBuildRange     criteriaProjId;
        QueryBuildRange     criteriaResource;
        QueryBuildRange     criteriaProjPriceGroup;
        QueryBuildRange     criteriaProjValidFor;

        boolean             fromMainSetup;
        CurrencyCode        currencyCode;
        ProjId              relationProjId;
        ProjPriceGroupID    relationPriceGroup;
        ProjId              projId;
        CustAccount         relationCustAccount;
        str                 relationDisplayText;

        #define.star("*")
        #DEFINE.displayOptionBlank("")
        #DEFINE.displayOptionTable("@SYS8868")
        #DEFINE.displayOptionGroup("@SYS3815")
        #DEFINE.displayOptionAll("@SYS11696")

        PriceDiscGroup          priceDiscGroup;
        ProjTable               projTable;
        ProjInvoiceTable        projInvoiceTable;
        CustTable               custTable;
        LedgerJournalTrans      ledgerJournalTrans;
        ProjForecastCost        projForecastCost;
        SMAAgreementTable       agreementTable;
        SMAServiceOrderTable    smaServiceOrderTable;
        ProjCategory            projCategory;
        HcmWorker               hcmWorker;
        ResourceView            resourceView;
        SalesQuotationTable     salesQuotationTable;

}
]]></Source>
			</Method>
			<Method>
				<Name>init</Name>
				<Source><![CDATA[
    public void init()
    {
        super();

        currencyCode        = Ledger::accountingCurrency(CompanyInfo::findDataArea(curext()).RecId);
        relationCustAccount = '';
        relationProjId      = '';
        relationDisplayText = '';

        if (isConfigurationkeyEnabled(configurationKeyNum(PriceDisc)))
        {
            // Record is required from the calling dataset
            if ((!element.args().record()) && (element.args().dataset()))
            {
                throw error("@SYS34359");
            }

            // Set defaults depending on the dataset
            switch (element.args().dataset())
            {
                case tableNum(PriceDiscGroup):
                    topGroup.visible(false);
                    displayOption.selection(TableGroupAll::GroupId);
                    break;

                case tableNum(ProjTable):
                    projTable           = element.args().record();
                    currencyCode        = projTable.currencyId();
                    relationProjId      = projTable.ProjId;
                    relationPriceGroup  = projTable.ProjPriceGroup;
                    relationDisplayText = relationProjId;
                    break;

                case tableNum(ProjInvoiceTable):
                    projInvoiceTable    = element.args().record();
                    currencyCode        = projInvoiceTable.CurrencyId;
                    relationProjId      = projInvoiceTable.ProjInvoiceProjId;
                    relationPriceGroup  = projInvoiceTable.ProjPriceGroup;
                    relationDisplayText = relationProjId;
                    break;

                case tableNum(CustTable):
                    custTable           = element.args().record();
                    currencyCode        = custTable.Currency;
                    relationPriceGroup  = custTable.PriceGroup;
                    relationCustAccount = custTable.AccountNum;
                    relationDisplayText = relationCustAccount;
                    break;

                case tableNum(LedgerJournalTrans):
                    ledgerJournalTrans  = element.args().record();
                    projTable           = ProjTable::findByLedgerDimension(ledgerJournalTrans.parmLedgerDimension());
                    currencyCode        = projTable.currencyId();
                    relationProjId      = projTable.ProjId;
                    relationPriceGroup  = projTable.ProjPriceGroup;
                    relationDisplayText = ledgerJournalTrans.parmAccount();
                    break;

                case tableNum(ProjForecastCost):
                    projForecastCost    = element.args().record();
                    projTable           = ProjTable::find(projForecastCost.ProjId);
                    currencyCode        = projTable.currencyId();
                    relationProjId      = projForecastCost.ProjId;
                    relationPriceGroup  = projTable.ProjPriceGroup;
                    relationDisplayText = relationProjId;
                    break;

                case(tableNum(SMAAgreementTable)):
                    agreementTable      = element.args().record();
                    projTable           = ProjTable::find(agreementTable.ProjId);
                    currencyCode        = projTable.currencyId();
                    relationProjId      = projTable.ProjId;
                    relationPriceGroup  = projTable.ProjPriceGroup;
                    relationDisplayText = relationProjId;
                    break;

                case(tableNum(SMAServiceOrderTable)):
                    smaServiceOrderTable = element.args().record();
                    projTable            = ProjTable::find(smaServiceOrderTable.ProjId);
                    currencyCode         = projTable.currencyId();
                    relationProjId       = projTable.ProjId;
                    relationPriceGroup   = projTable.ProjPriceGroup;
                    relationDisplayText  = relationProjId;
                    break;

                case(tableNum(ProjCategory)):
                    projCategory        = element.args().record();
                    relationDisplayText = projCategory.CategoryId;
                    break;

                case(tableNum(HcmWorker)):
                    hcmWorker           = element.args().record();
                    relationDisplayText = hcmWorker.PersonnelNumber;
                    break;

                case(tablenum(ResourceView)):
                    resourceView        = element.args().record();
                    relationDisplayText = resourceView.ResourceId;
                    break;

                case(tableNum(SalesQuotationTable)):
                    salesQuotationTable = element.args().record();
                    relationCustAccount = salesQuotationTable.CustAccount;
                    currencyCode        = salesQuotationTable.CurrencyCode;
                    relationPriceGroup  = salesQuotationTable.PriceGroupId;
                    relationDisplayText = salesQuotationTable.CustAccount;
                    break;
            }

            relation.text(relationDisplayText);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>initPriceGroupFields</Name>
				<Source><![CDATA[
    void initPriceGroupFields()
    {
        boolean     existingRecord;

        // Check if its an existing record
        if (projCostSalesPrice.RecId)
        {
            existingRecord = true;
        }

        // Disable and enable fields based on the value of ProjValidFor and where it was called
        switch (projCostSalesPrice.ProjValidFor)
        {
            case TableGroupAll::Table :
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).allowEdit(false);
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).skip(true);
                if ((element.args().dataset()) &&
                   ((element.args().dataset() != tableNum(ProjInvoiceTable)) &&
                    (element.args().dataset() != tableNum(CustTable)) &&
                    (element.args().dataset() != tableNum(HcmWorker)) &&
                    (element.args().dataset() != tablenum(ResourceView)) &&
                    (element.args().dataset() != tablenum(SalesQuotationTable)) &&
                    (element.args().dataset() != tableNum(ProjCategory))) || existingRecord)
                {
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).skip(true);
                }
                else
                {
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).allowEdit(true);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).skip(false);
                    if (isConfigurationkeyEnabled(configurationKeyNum(Project)))
                    {
                        projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaProjInvoiceProjId)).allowEdit(true);
                        projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaProjInvoiceProjId)).skip(false);
                        projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaCustAccount)).allowEdit(true);
                        projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaCustAccount)).skip(false);
                    }
                }
                break;

            case TableGroupAll::GroupId:
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).allowEdit(false);
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).skip(true);
                if (isConfigurationkeyEnabled(configurationKeyNum(Project)))
                {
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaProjInvoiceProjId)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaProjInvoiceProjId)).skip(true);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaCustAccount)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaCustAccount)).skip(true);
                }

                if ((element.args().dataset()) &&
                    ((element.args().dataset() != tableNum(HcmWorker)) &&
                    (element.args().dataset() != tablenum(ResourceView)) &&
                    (element.args().dataset() != tableNum(ProjCategory))) || existingRecord)
                {
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).skip(true);
                }
                else
                {
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).allowEdit(true);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).skip(false);
                }
                break;

            case TableGroupAll::All:
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).allowEdit(false);
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).skip(true);
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).allowEdit(false);
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).skip(true);
                if (isConfigurationkeyEnabled(configurationKeyNum(Project)))
                {
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaProjInvoiceProjId)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaProjInvoiceProjId)).skip(true);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaCustAccount)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, psaCustAccount)).skip(true);
                }

                break;
        }

        if ((displayOption.valueStr() == #displayOptionBlank) &&
            (element.args().dataset() != tableNum(PriceDiscGroup)) && !existingRecord)
        {
            projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjValidFor)).allowEdit(true);
            projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjValidFor)).skip(false);
        }
        else
        {
            if (element.args().dataset() &&
                ((element.args().dataset() == tablenum(HcmWorker)) ||
                (element.args().dataset() == tablenum(ResourceView)) ||
                (element.args().dataset() == tablenum(ProjCategory))))
            {
                ProjCostSalesPrice_DS.object(fieldnum(ProjCostSalesPrice, ProjValidFor)).allowEdit(true);
                ProjCostSalesPrice_DS.object(fieldnum(ProjCostSalesPrice, ProjValidFor)).skip(false);
            }
            else
            {
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjValidFor)).allowEdit(false);
                projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjValidFor)).skip(true);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>initRelation</Name>
				<Source><![CDATA[
    void initRelation()
    {
        projCostSalesPrice_ds.allowCreate(true);

        // Set value to relation field this is either ProjId, Price Group of empty.
        switch (displayOption.valueStr())
        {
            case #displayOptionBlank, #displayOptionAll:
                relation.text('');
                break;

            case #displayOptionTable:
                relation.text(relationDisplayText);
                break;

            case #displayOptionGroup:
                relation.text(relationPriceGroup);

                //
                // Don't allow to add records when there is no Price Group assigned to a ProjId except if
                // its called from main setup, HcmWorker, ResourceView or ProjCategory
                //
                if ((!relationPriceGroup) && (!fromMainSetup) &&
                    ((element.args().dataset() != tableNum(HcmWorker)) &&
                     (element.args().dataset() != tablenum(ResourceView)) &&
                     (element.args().dataset() != tableNum(ProjCategory))))
                {
                    projCostSalesPrice_ds.allowCreate(false);
                }
                break;
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>reSelect</Name>
				<Source><![CDATA[
    void reSelect()
    {
        // Rerun the query to get a new set of data based on the new Display Option selected
        this.initRelation();
        projCostSalesPrice_ds.init();
        projCostSalesPrice_ds.executeQuery();
        projCostSalesPrice_ds.queryRun().saveUserSetup(false);

        //
        // Don't display any records if ProjId or PriceGroup are empty except it is called from
        // HcmWorker, ResourceView, ProjCategory, CustTable, ProjInvoiceTable, SalesQuotationTable
        //
        if (!fromMainSetup &&
            (element.args().dataset() != tableNum(HcmWorker)) &&
            (element.args().dataset() != tablenum(ResourceView)) &&
            (element.args().dataset() != tableNum(ProjCategory)) &&
            (((displayOption.valueStr() == #displayOptionTable) &&
            (!relationProjId) &&
            (element.args().dataset() != tableNum(CustTable)) &&
            (element.args().dataset() != tableNum(SalesQuotationTable)) &&
            (element.args().dataset() != tableNum(ProjInvoiceTable))) ||
            ((displayOption.valueStr() == #displayOptionGroup) &&
            (!relationPriceGroup))))
        {
            projCostSalesPrice.doClear();
        }

        projCostSalesPrice_ds.refresh();
    }

]]></Source>
			</Method>
		</Methods>
		<DataSources xmlns="">
			<DataSource>
				<Name>ProjCostSalesPrice</Name>
				<Methods>
					<Method>
						<Name>active</Name>
						<Source><![CDATA[
        public int active()
        {
            int ret;

            ret = super();

            if (isConfigurationkeyEnabled(configurationKeyNum(PriceDisc)))
            {
                element.initPriceGroupFields();
            }

            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>initValue</Name>
						<Source><![CDATA[
        public void initValue()
        {
            super();

            projCostSalesPrice.CurrencyId = currencyCode;
            if (isConfigurationkeyEnabled(configurationKeyNum(PriceDisc)))
            {
                projCostSalesPrice.ProjId = '';
                projCostSalesPrice.ProjPriceGroup = '';

                projCostSalesPrice.ProjValidFor = displayOption.selection();

                switch (displayOption.valueStr())
                {
                    case #displayOptionBlank :
                        projCostSalesPrice.ProjValidFor = TableGroupAll::Table;
                        break;

                    case #displayOptionTable :
                        if (element.args().dataset() == tableNum(ProjInvoiceTable))
                        {
                            projCostSalesPrice.psaProjInvoiceProjId = relationProjId;
                        }
                        else if (element.args().dataset() == tableNum(CustTable) ||
                                element.args().dataset() == tableNum(SalesQuotationTable))
                        {
                            projCostSalesPrice.psaCustAccount = relationCustAccount;
                        }
                        else
                        {
                            projCostSalesPrice.ProjId = relationProjId;
                        }

                        projCostSalesPrice.ProjValidFor = TableGroupAll::Table;
                        break;

                    case #displayOptionGroup :
                        projCostSalesPrice.ProjPriceGroup = relationPriceGroup;
                        projCostSalesPrice.ProjValidFor = TableGroupAll::GroupId;
                        break;

                    case #displayOptionAll :
                        projCostSalesPrice.ProjValidFor = TableGroupAll::All;
                        break;
                }
            }
        }

]]></Source>
					</Method>
					<Method>
						<Name>linkActive</Name>
						<Source><![CDATA[
        void linkActive()
        {
            ProjForecastCost    tProjForecastCost;

            if (!isConfigurationkeyEnabled(configurationKeyNum(PriceDisc)))
            {
                switch (element.args().dataset())
                {
                    case(tableNum(ProjTable)):
                        projTable       = element.args().record();
                        currencyCode    = projTable.currencyId();
                        projId          = projTable.ProjId;
                        criteriaProjId.value(projId + #star);
                        break;

                    case(tableNum(SMAAgreementTable)):
                        agreementTable   = element.args().record();
                        projTable       = ProjTable::find(agreementTable.ProjId);
                        currencyCode    = projTable.currencyId();
                        projId          = projTable.ProjId;
                        criteriaProjId.value(projId);
                        break;

                    case(tableNum(ProjForecastCost)):
                        if (isConfigurationkeyEnabled(configurationKeyNum(Project)))
                        {
                            tProjForecastCost   = element.args().record();
                            projId              = tProjForecastCost.ProjId;
                            criteriaProjId.value(projId + #star);
                        }
                        break;
                }
            }

            super();
        }

]]></Source>
					</Method>
					<Method>
						<Name>init</Name>
						<Source><![CDATA[
        void init()
        {
            Query                   query;
            QueryBuildDataSource    qB;

            super();

            if (isConfigurationkeyEnabled(configurationKeyNum(PriceDisc)))
            {
                // Initialize choices in DisplayOption
                if (!(displayOption.getText(1)))
                {
                    if (!(element.args().dataset()))
                    {
                        displayOption.add(#displayOptionBlank);
                        fromMainSetup = true;
                    }

                    displayOption.add(#displayOptionTable);
                    displayOption.add(#displayOptionGroup);
                    displayOption.add(#displayOptionAll);
                }

                projCostSalesPrice_ds.autoQuery(false);
                query   = new Query();
                qB      = query.addDataSource(tableNum(ProjCostSalesPrice));

                // Caller is form PriceDiscGroup
                if ((element.args().dataset()) == tableNum(PriceDiscGroup))
                {
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjId)).skip(true);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).allowEdit(false);
                    projCostSalesPrice_ds.object(fieldNum(ProjCostSalesPrice, ProjPriceGroup)).skip(true);

                    priceDiscGroup = element.args().record();
                    relationPriceGroup = priceDiscGroup.GroupId;
                    criteriaProjPriceGroup = qB.addRange(fieldNum(ProjCostSalesPrice, ProjPriceGroup));
                    criteriaProjPriceGroup.value(relationPriceGroup);
                }
                else
                {
                    element.initRelation();

                    // Initialize query depending on selection in DisplayOption
                    switch (displayOption.valueStr())
                    {
                        case #displayOptionBlank :
                            break;

                        case #displayOptionTable :

                            switch (element.args().dataset())
                            {
                                case tableNum(ProjTable):
                                    criteriaProjId = qB.addRange(fieldNum(ProjCostSalesPrice, ProjId));
                                    projTable       = element.args().record();
                                    projId          = projTable.ProjId;
                                    criteriaProjId.value(projId + #star);
                                    break;

                                case tableNum(ProjInvoiceTable):
                                    criteriaProjId         = qB.addRange(fieldNum(ProjCostSalesPrice, psaProjInvoiceProjId));
                                    projInvoiceTable       = element.args().record();
                                    criteriaProjId.value(projInvoiceTable.ProjInvoiceProjId + #star);
                                    break;

                                case tableNum(CustTable):
                                    criteriaProjId         = qB.addRange(fieldNum(ProjCostSalesPrice, psaCustAccount));
                                    custTable              = element.args().record();
                                    criteriaProjId.value(custTable.AccountNum + #star);
                                    break;

                                case(tableNum(LedgerJournalTrans)):
                                    criteriaProjId   = qB.addRange(fieldNum(ProjCostSalesPrice, ProjId));
                                    ledgerJournalTrans = element.args().record();
                                    criteriaProjId.value(ledgerJournalTrans.parmAccount());
                                    break;

                                case(tableNum(ProjForecastCost)):
                                    criteriaProjId   = qB.addRange(fieldNum(ProjCostSalesPrice, ProjId));
                                    projForecastCost = element.args().record();
                                    criteriaProjId.value(projForecastCost.ProjId);
                                    break;

                                case(tableNum(SMAAgreementTable)):
                                    criteriaProjId = qB.addRange(fieldNum(ProjCostSalesPrice, ProjId));
                                    agreementTable = element.args().record();
                                    criteriaProjId.value(agreementTable.ProjId);
                                    break;

                                case(tableNum(SMAServiceOrderTable)):
                                    criteriaProjId = qB.addRange(fieldNum(ProjCostSalesPrice, ProjId));
                                    smaServiceOrderTable = element.args().record();
                                    criteriaProjId.value(smaServiceOrderTable.ProjId);
                                    break;

                                case(tableNum(ProjCategory)):
                                    criteriaProjId  = qB.addRange(fieldNum(ProjCostSalesPrice, CategoryId));
                                    projCategory    = element.args().record();
                                    criteriaProjId.value(projCategory.CategoryId + #star);
                                    break;

                                case(tableNum(HcmWorker)):
                                    criteriaResource = qB.addRange(fieldnum(ProjCostSalesPrice, Resource));
                                    hcmWorker       = element.args().record();
                                    criteriaResource.value(queryValue(ResourceFacade::findByWorker(hcmWorker.RecId)));
                                    break;

                                case(tablenum(ResourceView)):
                                    criteriaResource    = qB.addRange(fieldnum(ProjCostSalesPrice, Resource));
                                    resourceView        = element.args().record();
                                    criteriaResource.value(queryValue(resourceView.RecId));
                                    break;

                                case tableNum(SalesQuotationTable):
                                    criteriaProjId         = qB.addRange(fieldNum(ProjCostSalesPrice, psaCustAccount));
                                    salesQuotationTable    = element.args().record();
                                    criteriaProjId.value(salesQuotationTable.CustAccount + #star);
                                    break;

                                default:
                                    criteriaProjValidFor = qB.addRange(fieldNum(ProjCostSalesPrice, ProjValidFor));
                                    criteriaProjValidFor.value(int2str(TableGroupAll::Table));
                                    break;
                            }
                            break;

                        case #displayOptionGroup :

                            switch (element.args().dataset())
                            {
                                case tableNum(ProjTable),
                                     tableNum(ProjInvoiceTable),
                                     tableNum(CustTable),
                                     tableNum(LedgerJournalTrans),
                                     tableNum(ProjForecastCost),
                                     tableNum(SMAAgreementTable),
                                     tableNum(SalesQuotationTable),
                                     tableNum(SMAServiceOrderTable):
                                    criteriaProjPriceGroup = qB.addRange(fieldNum(ProjCostSalesPrice, ProjPriceGroup));
                                    criteriaProjPriceGroup.value(relationPriceGroup);
                                    break;

                                default:
                                    criteriaProjValidFor = qB.addRange(fieldNum(ProjCostSalesPrice, ProjValidFor));
                                    criteriaProjValidFor.value(int2str(TableGroupAll::GroupId));
                                    break;
                            }
                            break;

                        case #displayOptionAll :

                            criteriaProjValidFor = qB.addRange(fieldNum(ProjCostSalesPrice, ProjValidFor));
                            criteriaProjValidFor.value(int2str(TableGroupAll::All));
                            break;
                    }
                }
                projCostSalesPrice_ds.query(query);
            }
            else
            {
                switch (element.args().dataset())
                {
                    case tableNum(ProjTable), tableNum(SMAAgreementTable), tableNum(ProjForecastCost):
                        projCostSalesPrice_ds.autoQuery(false);
                        query   = new Query();
                        qB      = query.addDataSource(tableNum(ProjCostSalesPrice));

                        criteriaProjId      = qB.addRange(fieldNum(ProjCostSalesPrice, ProjId));
                        projCostSalesPrice_ds.query(query);
                        break;
                }
            }
        }

]]></Source>
					</Method>
				</Methods>
				<Fields>
					<Field>
						<DataField>ProjId</DataField>
						<Methods>
							<Method>
								<Name>modified</Name>
								<Source><![CDATA[
            public void modified()
            {
                super();

                // Only set the Sales Currency for a new record
                if (projCostSalesPrice.RecId == 0)
                {
                    projCostSalesPrice.CurrencyId = ProjTable::find(projCostSalesPrice.ProjId).currencyId();
                    projCostSalesPrice_ds.refresh();
                }
                if (isConfigurationkeyEnabled(configurationKeyNum(Project))
                    && projCostSalesPrice.ProjId != ''
                    && (projCostSalesPrice.psaProjInvoiceProjId != '' || projCostSalesPrice.psaCustAccount != ''))
                {
                    projCostSalesPrice.ProjId = '';
                    throw error("@PSA11510");
                }
            }

]]></Source>
							</Method>
						</Methods>
					</Field>
					<Field>
						<DataField>ProjValidFor</DataField>
						<Methods>
							<Method>
								<Name>modified</Name>
								<Source><![CDATA[
            public void modified()
            {
                super();

                element.initPriceGroupFields();
                projCostSalesPrice.ProjId = '';
                projCostSalesPrice.ProjPriceGroup = '';
                if (isConfigurationkeyEnabled(configurationKeyNum(Project)))
                {
                    projCostSalesPrice.psaCustAccount = '';
                    projCostSalesPrice.psaProjInvoiceProjId = '';
                }
            }

]]></Source>
							</Method>
						</Methods>
					</Field>
					<Field>
						<DataField>PSACustAccount</DataField>
						<Methods>
							<Method>
								<Name>modified</Name>
								<Source><![CDATA[
            public void modified()
            {
                super();

                if (isConfigurationkeyEnabled(configurationKeyNum(Project))
                    && projCostSalesPrice.psaCustAccount != ''
                    && (projCostSalesPrice.ProjId != '' || projCostSalesPrice.psaProjInvoiceProjId != ''))
                {
                    projCostSalesPrice.psaCustAccount = '';
                    throw error("@PSA11510");
                }
            }

]]></Source>
							</Method>
						</Methods>
					</Field>
					<Field>
						<DataField>PSAProjInvoiceProjId</DataField>
						<Methods>
							<Method>
								<Name>lookup</Name>
								<Source><![CDATA[
            public void lookup(FormControl _formControl, str _filterStr)
            {
                ProjInvoiceTable::psaLookupProjInvoiceProjId(_formControl, projCostSalesPrice.psaCustAccount);
            }

]]></Source>
							</Method>
							<Method>
								<Name>modified</Name>
								<Source><![CDATA[
            public void modified()
            {
                super();

                if (isConfigurationkeyEnabled(configurationKeyNum(Project))
                    && projCostSalesPrice.psaProjInvoiceProjId != ''
                    && (projCostSalesPrice.ProjId != '' || projCostSalesPrice.psaCustAccount != ''))
                {
                    projCostSalesPrice.psaProjInvoiceProjId = '';
                    throw error("@PSA11510");
                }
            }

]]></Source>
							</Method>
						</Methods>
					</Field>
					<Field>
						<DataField>Resource</DataField>
						<Methods>
							<Method>
								<Name>resolveReference</Name>
								<Source><![CDATA[
            /// <summary>
            /// Determines whether the input to the Resource field is a valid ResourceId or not.
            /// </summary>
            /// <param name = "_formReferenceControl">
            /// The form control that is bound to the Resource field.
            /// </param>
            /// <returns>
            /// The <c>HcmResource</c> record buffer that references the selected record.
            /// </returns>
            public Common resolveReference(FormReferenceControl _formReferenceControl)
            {
                ResourceView ret;

                ret = super(_formReferenceControl);

                if (ret.RecId && !ResourceLookup::validateResource(ret.RecId, projCostSalesPrice))
                {
                    ret = null;
                }

                return ret;
            }

]]></Source>
							</Method>
							<Method>
								<Name>lookupReference</Name>
								<Source><![CDATA[
            /// <summary>
            /// Opens the resource lookup.
            /// </summary>
            /// <param name = "_formReferenceControl">
            /// The form control that is bound to the Resource field.
            /// </param>
            /// <returns>
            /// The <c>HcmResource</c> record buffer that references the selected record.
            /// </returns>
            public Common lookupReference(FormReferenceControl _formReferenceControl)
            {
                return ResourceLookup::lookupResource(_formReferenceControl, projCostSalesPrice);
            }

]]></Source>
							</Method>
						</Methods>
					</Field>
				</Fields>
			</DataSource>
		</DataSources>
		<DataControls xmlns="">
			<Control>
				<Name>DisplayOption</Name>
				<Type>ComboBox</Type>
				<Methods>
					<Method>
						<Name>modified</Name>
						<Source><![CDATA[
        public boolean modified()
        {
            boolean ret;

            ret = super();

            element.reSelect();
            CategoryQuickFilter.applyFilter();

            return ret;
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
		</DataControls>
		<Members xmlns="" />
	</SourceCode>
	<DataSources>
		<AxFormDataSource xmlns="">
			<Name>ProjCostSalesPrice</Name>
			<Table>ProjCostSalesPrice</Table>
			<Fields>
				<AxFormDataSourceField>
					<DataField>CategoryId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CurrencyId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DataAreaId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Partition</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ProjId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ProjPriceGroup</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ProjSalesPriceModel</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ProjSalesPricing</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ProjValidFor</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PSACustAccount</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PSAProjInvoiceProjId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RecId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Resource</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TableId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TransDate</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Worker</DataField>
				</AxFormDataSourceField>
			</Fields>
			<ReferencedDataSources />
			<InsertIfEmpty>No</InsertIfEmpty>
			<DataSourceLinks />
			<DerivedDataSources />
		</AxFormDataSource>
	</DataSources>
	<Design>
		<Caption xmlns="">@SYS73784</Caption>
		<Pattern xmlns="">SimpleList</Pattern>
		<PatternVersion xmlns="">1.1</PatternVersion>
		<Style xmlns="">SimpleList</Style>
		<TitleDataSource xmlns="">ProjCostSalesPrice</TitleDataSource>
		<Controls xmlns="">
			<AxFormControl xmlns=""
				i:type="AxFormActionPaneControl">
				<Name>ActionPane</Name>
				<ElementPosition>715827882</ElementPosition>
				<FilterExpression>%1</FilterExpression>
				<Type>ActionPane</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<FormControlExtension
					i:nil="true" />
				<Controls />
				<AlignChild>No</AlignChild>
				<AlignChildren>No</AlignChildren>
				<ArrangeMethod>Vertical</ArrangeMethod>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormGroupControl">
				<Name>TopGroup</Name>
				<AutoDeclaration>Yes</AutoDeclaration>
				<ElementPosition>1193046470</ElementPosition>
				<FilterExpression>%1</FilterExpression>
				<Pattern>CustomAndQuickFilters</Pattern>
				<PatternVersion>1.1</PatternVersion>
				<Type>Group</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<WidthMode>SizeToAvailable</WidthMode>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl>
						<Name>CategoryQuickFilter</Name>
						<AutoDeclaration>Yes</AutoDeclaration>
						<FormControlExtension>
							<Name>QuickFilterControl</Name>
							<ExtensionComponents />
							<ExtensionProperties>
								<AxFormControlExtensionProperty>
									<Name>targetControlName</Name>
									<Type>String</Type>
									<Value>Grid</Value>
								</AxFormControlExtensionProperty>
								<AxFormControlExtensionProperty>
									<Name>defaultColumnName</Name>
									<Type>String</Type>
									<Value>ProjCostSalesPrice_CategoryId</Value>
								</AxFormControlExtensionProperty>
								<AxFormControlExtensionProperty>
									<Name>placeholderText</Name>
									<Type>String</Type>
								</AxFormControlExtensionProperty>
							</ExtensionProperties>
						</FormControlExtension>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormGroupControl">
						<Name>CustomFilter</Name>
						<Type>Group</Type>
						<FormControlExtension
							i:nil="true" />
						<Controls>
							<AxFormControl xmlns=""
								i:type="AxFormComboBoxControl">
								<Name>DisplayOption</Name>
								<AutoDeclaration>Yes</AutoDeclaration>
								<ConfigurationKey>PriceDisc</ConfigurationKey>
								<ElementPosition>1073741822</ElementPosition>
								<FilterExpression>%1</FilterExpression>
								<Type>ComboBox</Type>
								<VerticalSpacing>-1</VerticalSpacing>
								<FormControlExtension
									i:nil="true" />
								<ComboType>List</ComboType>
								<Label>@Proj:Display</Label>
								<ShowLabel>No</ShowLabel>
								<Items />
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormStringControl">
								<Name>Relation</Name>
								<AllowEdit>No</AllowEdit>
								<AutoDeclaration>Yes</AutoDeclaration>
								<ConfigurationKey>PriceDisc</ConfigurationKey>
								<ElementPosition>1610612733</ElementPosition>
								<FilterExpression>%1</FilterExpression>
								<Skip>Yes</Skip>
								<Type>String</Type>
								<VerticalSpacing>-1</VerticalSpacing>
								<FormControlExtension
									i:nil="true" />
								<Label>@SYS9114</Label>
								<ShowLabel>No</ShowLabel>
							</AxFormControl>
						</Controls>
						<ArrangeMethod>HorizontalRight</ArrangeMethod>
					</AxFormControl>
				</Controls>
				<AlignChild>No</AlignChild>
				<ArrangeMethod>HorizontalLeft</ArrangeMethod>
				<FrameType>None</FrameType>
				<Style>CustomFilter</Style>
				<ViewEditMode>Edit</ViewEditMode>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormGridControl">
				<Name>Grid</Name>
				<ElementPosition>1431655764</ElementPosition>
				<FilterExpression>%1</FilterExpression>
				<Type>Grid</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl xmlns=""
						i:type="AxFormDateControl">
						<Name>ProjCostSalesPrice_TransDate</Name>
						<ElementPosition>390451572</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>Date</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>TransDate</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
						<DisplayLength>15</DisplayLength>
						<DisplayLengthMode>Fixed</DisplayLengthMode>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormStringControl">
						<Name>ProjCostSalesPrice_CategoryId</Name>
						<ElementPosition>585677358</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>String</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>CategoryId</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormReferenceGroupControl">
						<Name>ProjCostSalesPrice_Resource</Name>
						<HeightMode>Auto</HeightMode>
						<Type>ReferenceGroup</Type>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<Controls />
						<DataSource>ProjCostSalesPrice</DataSource>
						<ReferenceField>Resource</ReferenceField>
						<ReplacementFieldGroup>ResourceId</ReplacementFieldGroup>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormComboBoxControl">
						<Name>ProjCostSalesPrice_ProjValidFor</Name>
						<ElementPosition>976128930</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>ComboBox</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>ProjValidFor</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
						<DisplayLength>15</DisplayLength>
						<DisplayLengthMode>Fixed</DisplayLengthMode>
						<Items />
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormStringControl">
						<Name>ProjCostSalesPrice_ProjId</Name>
						<ElementPosition>1171354716</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>String</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>ProjId</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormStringControl">
						<Name>ProjCostSalesPrice_PSAProjInvoiceProjId</Name>
						<ElementPosition>1236429978</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>String</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>PSAProjInvoiceProjId</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormStringControl">
						<Name>ProjCostSalesPrice_PSACustAccount</Name>
						<ElementPosition>1301505240</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>String</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>PSACustAccount</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormStringControl">
						<Name>ProjCostSalesPrice_PriceGroup</Name>
						<ElementPosition>1366580502</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>String</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>ProjPriceGroup</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormStringControl">
						<Name>ProjCostSalesPrice_CurrencyId</Name>
						<ElementPosition>1561806288</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>String</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>CurrencyId</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
						<DisplayLength>10</DisplayLength>
						<DisplayLengthMode>Fixed</DisplayLengthMode>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormComboBoxControl">
						<Name>ProjCostSalesPrice_ProjSalesPriceModel</Name>
						<ElementPosition>1757032074</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Type>ComboBox</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>ProjSalesPriceModel</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
						<Items />
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormRealControl">
						<Name>ProjCostSalesPrice_ProjSalesPricing</Name>
						<ElementPosition>1952257860</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<HelpText>@FieldDescriptions_ProjectManagementAndAccounting:ProjSalesPriceCost_ProjCostSalesPrice_ProjSalesPricing</HelpText>
						<Type>Real</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<DataField>ProjSalesPricing</DataField>
						<DataSource>ProjCostSalesPrice</DataSource>
						<NoOfDecimals>-1</NoOfDecimals>
					</AxFormControl>
				</Controls>
				<AlternateRowShading>No</AlternateRowShading>
				<DataSource>ProjCostSalesPrice</DataSource>
				<ShowRowLabels>No</ShowRowLabels>
				<Style>Tabular</Style>
			</AxFormControl>
		</Controls>
	</Design>
	<Parts />
</AxForm>