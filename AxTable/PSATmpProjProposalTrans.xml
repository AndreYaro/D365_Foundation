<?xml version="1.0" encoding="utf-8"?>
<AxTable xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>PSATmpProjProposalTrans</Name>
	<SourceCode>
		<Declaration><![CDATA[
public class PSATmpProjProposalTrans extends common
{
    
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>calcLineAmount</Name>
				<Source><![CDATA[
      public void calcLineAmount()
    {
        this.LineAmount = CurrencyExchangeHelper::amount(this.Qty * this.SalesPrice, this.CurrencyCode);
    }

]]></Source>
			</Method>
			<Method>
				<Name>canShowIndirectComponentTrans</Name>
				<Source><![CDATA[
    public boolean canShowIndirectComponentTrans()
    {
        return this.IndirectComponentGroup != '';
    }

]]></Source>
			</Method>
			<Method>
				<Name>creditNote</Name>
				<Source><![CDATA[
    [SysClientCacheDataMethodAttribute(false)]
    public display NoYes creditNote()
    {
        if (this.TransStatus == ProjTransStatus::MarkedCreditnote)
        {
            return NoYes::Yes;
        }

        // sales line doesn't use MarkedCreditnote
        if (this.TransType == ProjTransType::Item
        && this.Qty < 0)
        {
            return NoYes::Yes;
        }

        return NoYes::No;
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromProjCostTrans</Name>
				<Source><![CDATA[
    public void initFromProjCostTrans(PSAProjTrans tProjCostTrans)
    {
        ProjTable   tProjTable = ProjTable::find(tProjCostTrans.ProjId);

        this.initFromProjTrans(tProjCostTrans);
        this.ActivityNumber = tProjCostTrans.ActivityNumber;
        this.Purpose = smmActivities::find(tProjCostTrans.ActivityNumber).Purpose;
        this.Selected = NoYes::Yes;
        this.CustAccount = tProjTable.CustAccount;
        this.ProjInvoiceProjId = tProjTable.ProjInvoiceProjId;
        this.ProjId = tProjCostTrans.ProjId;
        this.TransType = ProjTransType::Cost;
        this.Txt = tProjCostTrans.Txt;
        this.CategoryId = tProjCostTrans.CategoryId;
        this.Resource = tProjCostTrans.Resource;
        this.TransDate = tProjCostTrans.TransDate;
        this.Qty = tProjCostTrans.Qty;
        this.CurrencyCode = tProjCostTrans.CurrencyId;
        this.RefRecIdTrans = tProjCostTrans.RecId;
        this.RefTableId = tProjCostTrans.TableId;
        this.RefTransId = tProjCostTrans.TransId;
        this.DefaultDimension = tProjCostTrans.DefaultDimension;
        if (this.TransStatus == ProjTransStatus::MarkedCreditnote)
        {
            this.Qty = -this.Qty;
            this.LineAmount = -this.LineAmount;
        }
        // <GTE>
        if (TaxIntegrationUtils::isTaxInformationEnabled())
        {
            this.TaxInformation_IN = TransTaxInformationHelper::findOrCreateTransTaxInformationByRecord(tProjCostTrans).TaxInformation;
        }
        // </GTE>
        // <GIN>
        if (TaxParameters::checkTaxParameters_IN())
        {
            this.ServiceEventGroup_IN = ProjCostTransTaxExtensionIN::findByProjCostTrans(ProjCostTrans::find(tProjCostTrans.TransId).RecId).ServiceEventGroup;
        }
        this.LinePropertyId = tProjCostTrans.LinePropertyId;
        this.TaxGroupId = tProjCostTrans.TaxGroupId;
        this.TaxItemGroupId = tProjCostTrans.TaxItemGroupId;

        if (this.Resource)
        {
            ResourceView resourceView = ResourceFacade::getResourceView(tProjCostTrans.Resource);
            if (resourceView)
            {
                this.ResourceName = resourceView.Name;
                this.ResourceId = resourceView.ResourceId;
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromProjEmplTrans</Name>
				<Source><![CDATA[
    public void initFromProjEmplTrans(PSAProjTrans  _tProjEmplTrans)
    {
        ProjEmplTrans               tProjEmplTrans;
        ProjEmplTransSale           projEmplTransSale;
        ProjTable                   tProjTable = ProjTable::find(_tProjEmplTrans.ProjId);
        // <GIN>
        TransTaxInformation         transTaxInformation;
        // </GIN>

        this.initFromProjTrans(_tProjEmplTrans);
        this.ActivityNumber = _tProjEmplTrans.ActivityNumber;
        this.Purpose = smmActivities::find(_tProjEmplTrans.ActivityNumber).Purpose;
        this.Selected = NoYes::Yes;
        this.CustAccount = tProjTable.CustAccount;
        this.ProjInvoiceProjId = tProjTable.ProjInvoiceProjId;
        this.ProjId = _tProjEmplTrans.ProjId;
        this.TransType = ProjTransType::Hour;
        this.Txt = _tProjEmplTrans.Txt;

        if (_tProjEmplTrans.TableId == tableNum(ProjEmplTrans))
        {
            tProjEmplTrans = _tProjEmplTrans;
        }

        if (isConfigurationkeyEnabled(configurationKeyNum(Project)) &&
           tProjEmplTrans.psaIndirectComponentGroup)
        {
            //sum because there can be multiple funding sources
            select sum(psaIndirectInvoice) from projEmplTransSale
            where projEmplTransSale.TransId == tProjEmplTrans.TransId ;

            this.IndirectComponentGroup = tProjEmplTrans.psaIndirectComponentGroup;
            this.IndirectAmount = projEmplTransSale.psaIndirectInvoice;
        }
        else
        {
            this.IndirectComponentGroup = '';
            this.IndirectAmount         = 0;
        }

        this.CategoryId = _tProjEmplTrans.CategoryId;
        this.Resource = _tProjEmplTrans.Resource;
        this.TransDate = _tProjEmplTrans.TransDate;
        this.Qty = _tProjEmplTrans.Qty;
        this.CurrencyCode = _tProjEmplTrans.CurrencyId;
        this.RefRecIdTrans = _tProjEmplTrans.RecId;
        this.RefTableId = _tProjEmplTrans.TableId;
        this.RefTransId = _tProjEmplTrans.TransId;
        this.DefaultDimension = _tProjEmplTrans.DefaultDimension;
        if (_tProjEmplTrans.Resource)
        {
            ResourceView resourceView = ResourceFacade::getResourceView(_tProjEmplTrans.Resource);
            if (resourceView) 
            {
                this.ResourceName = resourceView.Name;
                this.ResourceId = resourceView.ResourceId;
            }
        }

        // Description: Added condition for credit note wih indirect component
        if (this.TransStatus == ProjTransStatus::MarkedCreditnote)
        {
            this.Qty = -this.Qty;
            this.LineAmount = -this.LineAmount;
        }

        // <GTE>
        if (TaxIntegrationUtils::isTaxInformationEnabled())
        {
            transTaxInformation = TransTaxInformationHelper::findOrCreateTransTaxInformationByRecord(tprojEmplTrans);
            this.TaxInformation_IN = transTaxInformation.TaxInformation;
        }
        // </GTE>
        // <GIN> 
        if (TaxParameters::checkTaxParameters_IN())
        {
           this.ServiceEventGroup_IN = ProjEmplTransTaxExtensionIN::findByProjEmplTrans(ProjEmplTrans::find(_tProjEmplTrans.TransId).RecId).ServiceEventGroup;
        }
        this.LinePropertyId = _tProjEmplTrans.LinePropertyId;
        this.TaxGroupId = _tProjEmplTrans.TaxGroupId;
        this.TaxItemGroupId = _tProjEmplTrans.TaxItemGroupId;
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromProjItemTrans</Name>
				<Source><![CDATA[
    public void initFromProjItemTrans(PSAProjTrans tProjItemTrans)
    {
        ProjTable   tProjTable = ProjTable::find(tProjItemTrans.ProjId);
        // <GIN>
        TransTaxInformation      transTaxInformation;
        // </GIN>

        this.initFromProjTrans(tProjItemTrans);
        this.ActivityNumber = tProjItemTrans.ActivityNumber;
        this.Purpose = smmActivities::find(tProjItemTrans.ActivityNumber).Purpose;
        this.Selected = NoYes::Yes;
        this.CustAccount = tProjTable.CustAccount;
        this.ProjInvoiceProjId = tProjTable.ProjInvoiceProjId;
        this.ProjId = tProjItemTrans.ProjId;
        this.TransType = ProjTransType::Item;
        this.Txt = tProjItemTrans.Txt;
        this.CategoryId = tProjItemTrans.CategoryId;
        this.Resource = 0;
        this.TransDate = tProjItemTrans.TransDate;
        this.Qty = tProjItemTrans.SalesQty? tProjItemTrans.SalesQty: tProjItemTrans.Qty;
        this.CurrencyCode = tProjItemTrans.CurrencyId;
        this.RefRecIdTrans = tProjItemTrans.RecId;
        this.RefTableId = tProjItemTrans.TableId;
        this.RefTransId = tProjItemTrans.TransId;
        this.DefaultDimension = tProjItemTrans.DefaultDimension;
        this.SalesUnit = tProjItemTrans.SalesUnit;

        // Description: Added condition for credit note wih indirect component
        if (this.TransStatus == ProjTransStatus::MarkedCreditnote)
        {
            this.Qty = -this.Qty;
            this.LineAmount = -this.LineAmount;
        }
        // <GTE>
        if (TaxIntegrationUtils::isTaxInformationEnabled())
        {
            transTaxInformation = TransTaxInformationHelper::findOrCreateTransTaxInformationByRecord(tProjItemTrans);
            this.TaxInformation_IN = transTaxInformation.TaxInformation;
        }
        // </GTE>
        // <GIN>
        if (TaxParameters::checkTaxParameters_IN())
        {
            this.ServiceEventGroup_IN = ProjItemTransTaxExtensionIN::findByProjItemTrans(ProjItemTrans::find(tProjItemTrans.TransId).RecId).ServiceEventGroup;
        }
        // </GIN>
        this.LinePropertyId = tProjItemTrans.LinePropertyId;
        this.TaxGroupId = tProjItemTrans.TaxGroupId;
        this.TaxItemGroupId = tProjItemTrans.TaxItemGroupId;
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromProjOnAccTrans</Name>
				<Source><![CDATA[
    public void initFromProjOnAccTrans(PSAProjTrans tProjOnAccTrans)
    {
        ProjTable       tProjTable = ProjTable::find(tProjOnAccTrans.ProjId);
        // <GIN>
        TransTaxInformation      transTaxInformation;
        // </GIN>

        this.initFromProjTrans(tProjOnAccTrans);
        this.ActivityNumber = tProjOnAccTrans.ActivityNumber;
        this.Purpose = smmActivities::find(tProjOnAccTrans.ActivityNumber).Purpose;
        this.Selected = NoYes::Yes;
        this.CustAccount = tProjTable.CustAccount;
        this.ProjInvoiceProjId = tProjTable.ProjInvoiceProjId;
        this.ProjId = tProjOnAccTrans.ProjId;
        this.TransType = ProjTransType::OnAccount;

        if (ProjOnAccountCategoryToggle::instance().isEnabled())
        {
            this.CategoryId = tProjOnAccTrans.CategoryId;
        }
        else
        {
            this.CategoryId = '';
        }

        this.Resource = 0;
        this.TransDate = tProjOnAccTrans.TransDate;
        this.Qty = tProjOnAccTrans.Qty;
        this.CurrencyCode = tProjOnAccTrans.CurrencyId;
        this.SalesPrice = tProjOnAccTrans.transTurnover(); // qty is always 1, Sales Price == Line amount (turnover)
        this.LineAmount = tProjOnAccTrans.transTurnover();
        this.Txt = tProjOnAccTrans.Txt;
        this.RefRecIdTrans = tProjOnAccTrans.RecId;
        this.RefTableId = tProjOnAccTrans.TableId;
        this.RefTransId = tProjOnAccTrans.TransId;
        this.DefaultDimension = tProjOnAccTrans.DefaultDimension;

        // Description: Added condition for credit note wih indirect component
        if (this.TransStatus == ProjTransStatus::MarkedCreditnote)
        {
            this.Qty = -this.Qty;
            this.LineAmount = -this.LineAmount;
        }

        // <GTE>
        if (TaxIntegrationUtils::isTaxInformationEnabled())
        {
            TransTaxInformationHelper transTaxInformationHelper = TransTaxInformationHelper::newHelper();
            if (tProjOnAccTrans.TransactionOrigin == ProjOrigin::Deduction && !transTaxInformationHelper.findTransTaxInformationByRecord(tProjOnAccTrans))
            {
                ProjOnAccTrans projOnAccTransOrig, projOnAccTrans;

                projOnAccTrans = ProjOnAccTrans::find(tProjOnAccTrans.TransId);
                select firstonly projOnAccTransOrig
                    where projOnAccTransOrig.RecId == projOnAccTrans.psaRefRecId;

                TransTaxInformationHelper::copyTransTaxInformation(projOnAccTransOrig, projOnAccTrans);
                transTaxInformation = transTaxInformationHelper.findTransTaxInformationByRecord(projOnAccTrans);
            }
            else
            {
                transTaxInformation = TransTaxInformationHelper::findOrCreateTransTaxInformationByRecord(tProjOnAccTrans);
            }
            this.TaxInformation_IN = transTaxInformation.TaxInformation;
        }
        // </GTE>
        this.TaxGroupId = tProjOnAccTrans.TaxGroupId;
        this.TaxItemGroupId = tProjOnAccTrans.TaxItemGroupId;
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromProjRevenueTrans</Name>
				<Source><![CDATA[
    public void initFromProjRevenueTrans(PSAProjTrans tProjRevenueTrans)
    {
        ProjTable   tProjTable = ProjTable::find(tProjRevenueTrans.ProjId);
        // <GIN>
        TransTaxInformation      transTaxInformation;
        // </GIN>

        this.initFromProjTrans(tProjRevenueTrans);
        this.ActivityNumber = tProjRevenueTrans.ActivityNumber;
        this.Purpose = smmActivities::find(tProjRevenueTrans.ActivityNumber).Purpose;
        this.Selected = NoYes::Yes;
        this.CustAccount = tProjTable.CustAccount;
        this.ProjInvoiceProjId = tProjTable.ProjInvoiceProjId;
        this.ProjId = tProjRevenueTrans.ProjId;
        this.TransType = ProjTransType::Revenue;
        this.Txt = tProjRevenueTrans.Txt;
        this.CategoryId = tProjRevenueTrans.CategoryId;
        this.Resource = tProjRevenueTrans.Resource;
        this.TransDate = tProjRevenueTrans.TransDate;
        this.Qty = tProjRevenueTrans.Qty;
        this.CurrencyCode = tProjRevenueTrans.CurrencyId;
        this.RefRecIdTrans = tProjRevenueTrans.RecId;
        this.RefTableId = tProjRevenueTrans.TableId;
        this.RefTransId = tProjRevenueTrans.TransId;
        this.IsRetained = tProjRevenueTrans.IsRetained;
        this.IsReleased = tProjRevenueTrans.IsReleased;
        this.DefaultDimension = tProjRevenueTrans.DefaultDimension;
        // Description:Added condition for credit note wih indirect component
        if (this.TransStatus == ProjTransStatus::MarkedCreditnote)
        {
            this.Qty = -this.Qty;
            this.LineAmount = -this.LineAmount;
        }

        // <GTE>
        if (TaxIntegrationUtils::isTaxInformationEnabled())
        {
            transTaxInformation = TransTaxInformationHelper::findOrCreateTransTaxInformationByRecord(tProjRevenueTrans);
            this.TaxInformation_IN = transTaxInformation.TaxInformation;
        }
        // </GTE>
        // <GIN>
        if (TaxParameters::checkTaxParameters_IN())
        {
            this.ServiceEventGroup_IN = ProjRevenueTransTaxExtensionIN::findByProjRevenueTrans(ProjRevenueTrans::find(tProjRevenueTrans.TransId).RecId).ServiceEventGroup;
        }
        // </GIN>
        this.LinePropertyId = tProjRevenueTrans.LinePropertyId;
        this.TaxGroupId = tProjRevenueTrans.TaxGroupId;
        this.TaxItemGroupId = tProjRevenueTrans.TaxItemGroupId;
       
        if (this.Resource)
        {
            ResourceView resourceView = ResourceFacade::getResourceView(tProjRevenueTrans.Resource);
            if (resourceView)
            {
                this.ResourceName = resourceView.Name;
                this.ResourceId = resourceView.ResourceId;
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromProjTrans</Name>
				<Source><![CDATA[
    private void initFromProjTrans(PSAProjTrans _projTrans)
    {
        this.TransactionOrigin = _projTrans.TransactionOrigin;
    }

]]></Source>
			</Method>
			<Method>
				<Name>initProjAndOriginFieldsFromSalesLine</Name>
				<Source><![CDATA[
    private void initProjAndOriginFieldsFromSalesLine(SalesLine _salesLine, SalesQty _deliverNow)
    {
        ProjTable projTable = ProjTable::find(_salesLine.ProjId);

        this.TransactionOrigin  = ProjOrigin::SalesOrder;
        this.Selected           = NoYes::Yes;
        this.CustAccount        = _salesLine.CustAccount;
        this.ProjInvoiceProjId  = projTable.ProjInvoiceProjId;
        this.ProjId             = _salesLine.ProjId;
        this.TransType          = ProjTransType::Item;
        this.Txt                = _salesLine.Name;
        this.CategoryId         = _salesLine.ProjCategoryId;
        this.Resource           = 0;
        this.TransDate          = _salesLine.ConfirmedDlv;
        this.Qty                = _deliverNow;
        this.CurrencyCode       = _salesLine.CurrencyCode;
    }

]]></Source>
			</Method>
			<Method>
				<Name>initLineAmountFieldsFromSalesLine</Name>
				<Source><![CDATA[
    private void initLineAmountFieldsFromSalesLine(SalesLine _salesLine, SalesQty _deliverNow)
    {
        this.SalesPrice     = _salesLine.SalesPrice;
        this.LineAmount     = _salesLine.calcLineAmount(_deliverNow);
    }

]]></Source>
			</Method>
			<Method>
				<Name>initOtherFieldsFromSalesLine</Name>
				<Source><![CDATA[
    private void initOtherFieldsFromSalesLine(SalesLine _salesLine, SalesQty _deliverNow)
    {
        this.RefRecIdTrans      = _salesLine.RecId;
        this.RefTableId         = _salesLine.TableId;
        this.RefTransId         = _salesLine.InventTransId;
        this.DefaultDimension   = _salesLine.DefaultDimension;
        this.FixedExchRate      = _salesLine.salesTable().FixedExchRate;

        switch (_salesLine.SalesStatus)
        {
            case SalesStatus::Invoiced:
                this.TransStatus = ProjTransStatus::Invoiced;
                break;

            default:
                this.TransStatus = ProjTransStatus::NoStatus;
                break;
        }

        if (TaxIntegrationUtils::isTaxInformationEnabled())
        {
            TransTaxInformation transTaxInformation = TransTaxInformationHelper::findOrCreateTransTaxInformationByRecord(_salesLine);
            this.TaxInformation_IN = transTaxInformation.TaxInformation;
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromSalesLine</Name>
				<Source><![CDATA[
    /// <summary>
    /// Initializes the <c>PSATmpProjProposalTrans</c> record from the <c>SalesLine</c> record.
    /// </summary>
    /// <param name = "salesLine">The record to initialize from.</param>
    /// <param name = "deliverNow">Deliver now quantity.</param>
    public void initFromSalesLine(SalesLine salesLine, SalesQty deliverNow)
    {
        this.initProjAndOriginFieldsFromSalesLine(salesLine, deliverNow);
        this.initLineAmountFieldsFromSalesLine(salesLine, deliverNow);
        this.initOtherFieldsFromSalesLine(salesLine, deliverNow);
    }

]]></Source>
			</Method>
			<Method>
				<Name>initFromSalesLineExceptLineAmount</Name>
				<Source><![CDATA[
    /// <summary>
    /// Initializes the <c>PSATmpProjProposalTrans</c> record from the <c>SalesLine</c> record, but skips initialization of price and amount related fields.
    /// </summary>
    /// <param name = "salesLine">The record to initialize from.</param>
    /// <param name = "deliverNow">Deliver now quantity.</param>
    public void initFromSalesLineExceptLineAmount(SalesLine salesLine, SalesQty deliverNow)
    {
        this.initProjAndOriginFieldsFromSalesLine(salesLine, deliverNow);
        this.initOtherFieldsFromSalesLine(salesLine, deliverNow);
    }

]]></Source>
			</Method>
			<Method>
				<Name>modifiedField</Name>
				<Source><![CDATA[
    public void modifiedField(FieldId _fieldId)
    {
        super(_fieldId);

        switch (_fieldId)
        {
            case fieldNum(PSATmpProjProposalTrans, PercentInvoiceNow) :
                this.InvoiceNow = CurrencyExchangeHelper::amount(this.TotalBudget * this.PercentInvoiceNow / 100, ProjTable::find(this.ProjId).currencyId());
                break;

            case fieldNum(PSATmpProjProposalTrans, InvoiceNow) :
                if (this.TotalBudget != 0)
                {
                    this.PercentInvoiceNow = round(((this.InvoiceNow / this.TotalBudget) * 100), 0.01);
                }
                break;
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>nextLineNum</Name>
				<Source><![CDATA[
    LineNum nextLineNum(PSATmpProjProposalTrans _psaTmpProjProposalTrans)
    {
        select firstonly LineNum
        from _psaTmpProjProposalTrans
        order by LineNum
         where  _psaTmpProjProposalTrans.LineNum      > this.LineNum;

        return _psaTmpProjProposalTrans.LineNum;
    }

]]></Source>
			</Method>
			<Method>
				<Name>offsetTrans</Name>
				<Source><![CDATA[
    public display NoYes offsetTrans()
    {
        if (this.TransType != ProjTransType::OnAccount)
        {
            return NoYes::No;
        }

        return (select firstonly * from projOnAccTrans
                where projOnAccTrans.RecId == this.RefRecIdTrans).TransactionOrigin == ProjOrigin::Deduction ? NoYes::Yes : NoYes::No;
    }

]]></Source>
			</Method>
			<Method>
				<Name>resourceName</Name>
				<Source><![CDATA[
    public display ResResourceName resourceName()
    {
        return ResourceFacade::getName(this.Resource);
    }

]]></Source>
			</Method>
			<Method>
				<Name>expandAndSelect</Name>
				<Source><![CDATA[
    public static void expandAndSelect(ProjTable _projTable, FormTreeControl _tree)
    {
        Stack   stack;
        ProjId  rootProjId,subProjId;
        int     idx;

        if (!_projTable)
        {
            return;
        }

        stack = new Stack();
        PSATmpProjProposalTrans::getParent(_projTable.ProjId, stack);

        _tree.lockWindowUpdate(true);
        idx = _tree.getRoot();
        while (stack.qty())
        {
            [rootProjId]     = stack.pop();
            subProjId   = _tree.getItem(idx).data();

            while (subProjId != rootProjId)
            {
                idx = _tree.getNextVisible(idx);
                subProjId   = _tree.getItem(idx).data();
            }

            _tree.select(idx);

            if (stack.qty())
            {
                _tree.expand(idx, FormTreeExpand::Expand);
            }
        }

        _tree.lockWindowUpdate(false);
    }

]]></Source>
			</Method>
			<Method>
				<Name>getParent</Name>
				<Source><![CDATA[
    public static void getParent(ProjId _projId, Stack _stack)
    {
        ProjTable projTable;

        select firstonly projTable where projTable.ProjId == _projId;

        if (projTable)
        {
            _stack.push([projTable.ProjId]);
            PSATmpProjProposalTrans::getParent(projTable.ParentId, _stack);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>insertIndirectComponentTrans</Name>
				<Source><![CDATA[
    public static PSATmpProjProposalTrans insertIndirectComponentTrans(PSAProjTrans  _tProjEmplTrans, PSATmpProjProposalTrans _tProjProposalTrans)
    {
        PSAIndirectComponentTrans       tIndirectComponentTrans;
        ProjTable                       tProjTable = ProjTable::find(_tProjEmplTrans.ProjId);

        while select IndirectComponentGroup, IndirectComponentId, Amount, RecId, TableId from tIndirectComponentTrans
           where tIndirectComponentTrans.TransId                == _tProjEmplTrans.TransId      &&
                 tIndirectComponentTrans.IndirectComponentType  == PSAIndirectComponentType::Invoice    &&
                 tIndirectComponentTrans.Amount                 != 0 //exclude lines with Amount 0
        {
            _tProjProposalTrans.selectForUpdate(true);
            _tProjProposalTrans.IndirectAmount          = tIndirectComponentTrans.Amount;
            _tProjProposalTrans.LineAmount              = _tProjProposalTrans.LineAmount + _tProjProposalTrans.IndirectAmount;

            // Description: Added condition for credit note wih indirect component
            if (_tProjProposalTrans.TransStatus == ProjTransStatus::MarkedCreditnote || _tProjProposalTrans.TransStatus == ProjTransStatus::CreditnoteProposal)
            {
                _tProjProposalTrans.Qty = -1;
                _tProjProposalTrans.LineAmount = -(_tProjProposalTrans.LineAmount + _tProjProposalTrans.IndirectAmount);
            }

            _tProjProposalTrans.update();
        }
        return _tProjProposalTrans;
    }

]]></Source>
			</Method>
			<Method>
				<Name>lookupProjIdHierarchy</Name>
				<Source><![CDATA[
    public static void lookupProjIdHierarchy(FormControl _formControl, str _filterStr, ProjId _projId)
    {
        Query                   q = new Query();
        QueryBuildDataSource    qbr1;

        SysTableLookup  sysTableLookup;

        qbr1 = q.addDataSource(tableNum(ProjTable));

        qbr1.addRange(fieldNum(ProjTable, ProjId)).value(queryValue(_projId) + "@SYS35668");

        sysTableLookup  = SysTableLookup::newParameters(tableNum(ProjTable), _formControl);
        sysTableLookup.addLookupfield(fieldNum(ProjTable, ProjId), true);
        sysTableLookup.addLookupfield(fieldNum(ProjTable, Name), false);

        sysTableLookup.parmQuery(q);
        sysTableLookup.performFormLookup();
    }

]]></Source>
			</Method>
			<Method>
				<Name>totalDeduction</Name>
				<Source><![CDATA[
    public static ProjTotalInvoiceDeductionAmount totalDeduction(PSATmpProjProposalTrans _psaTmpProjProposalTransPreBill)
    {
        PSATmpProjProposalTrans psaTmpProjProposalTransLoc;

        psaTmpProjProposalTransLoc.setTmpData(_psaTmpProjProposalTransPreBill);

        select sum(LineAmount) from psaTmpProjProposalTransLoc
                where psaTmpProjProposalTransLoc.Selected == NoYes::Yes;

        return psaTmpProjProposalTransLoc.LineAmount;
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
	<ConfigurationKey>Project</ConfigurationKey>
	<Label>@PSA1626</Label>
	<TableGroup>WorksheetLine</TableGroup>
	<ClusteredIndex></ClusteredIndex>
	<CreateRecIdIndex>No</CreateRecIdIndex>
	<PrimaryIndex></PrimaryIndex>
	<TableType>InMemory</TableType>
	<DeleteActions />
	<FieldGroups>
		<AxTableFieldGroup>
			<Name>AutoReport</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoLookup</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoIdentification</Name>
			<AutoPopulate>Yes</AutoPopulate>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoSummary</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoBrowse</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>GrpContractLine</Name>
			<Label>@PSA2823</Label>
			<Fields>
				<AxTableFieldGroupField>
					<DataField>ContractLineNum</DataField>
				</AxTableFieldGroupField>
			</Fields>
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>grpGrid1</Name>
			<Label>@SYS29051</Label>
			<Fields>
				<AxTableFieldGroupField>
					<DataField>Selected</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>CustAccount</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>ProjInvoiceProjId</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>ProjId</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>TransType</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>Txt</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>Task</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>CategoryId</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>Resource</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>TransDate</DataField>
				</AxTableFieldGroupField>
			</Fields>
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>grpGrid2</Name>
			<Label>@SYS75670</Label>
			<Fields>
				<AxTableFieldGroupField>
					<DataField>Qty</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>SalesPrice</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>CurrencyCode</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>LineAmount</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>CapExempt</DataField>
				</AxTableFieldGroupField>
			</Fields>
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>IndirectComponent</Name>
			<Label>@PSA2394</Label>
			<Fields>
				<AxTableFieldGroupField>
					<DataField>IndirectComponent</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>IndirectComponentGroup</DataField>
				</AxTableFieldGroupField>
			</Fields>
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>FundingSource</Name>
			<Label>@SYS134468</Label>
			<Fields>
				<AxTableFieldGroupField>
					<DataField>FundingSourceRefId</DataField>
				</AxTableFieldGroupField>
			</Fields>
		</AxTableFieldGroup>
	</FieldGroups>
	<Fields>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ActivityNumber</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjActivityNumber</ExtendedDataType>
			<Label>@SYS38381</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>CapExempt</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>NoYesId</ExtendedDataType>
			<Label>@PSA1902</Label>
			<EnumType>NoYes</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>CapInvoiceAmount</Name>
			<AllowEdit>No</AllowEdit>
			<AllowEditOnCreate>No</AllowEditOnCreate>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>Amount</ExtendedDataType>
			<Label>@PSA2273</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>CategoryId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjCategoryId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ContractLineNum</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>PSAContractLineNum</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>ContractLineType</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<EnumType>PSAContractLineType</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>ContractLineValue</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>Amount</ExtendedDataType>
			<Label>@SYS40283</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>CurrencyCode</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>CurrencyCode</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>CustAccount</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>CustAccount</ExtendedDataType>
			<Label>@PSA175</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt64">
			<Name>DefaultDimension</Name>
			<AllowEdit>No</AllowEdit>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>DimensionDefault</ExtendedDataType>
			<Visible>No</Visible>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>DEL_EmplId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ConfigurationKey>SysDeletedObjects60</ConfigurationKey>
			<ExtendedDataType>DEL_EmplId</ExtendedDataType>
			<IgnoreEDTRelation>Yes</IgnoreEDTRelation>
			<Visible>No</Visible>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ForecastModelId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ForecastModelId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt64">
			<Name>FundingSourceRefId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjFundingSourceRefId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>IndirectAmount</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>Amount</ExtendedDataType>
			<Label>@PSA2394</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>IndirectComponent</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>PSAIndirectComponentId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>IndirectComponentGroup</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>PSAIndirectComponentGroupId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>Interdependences</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<Label>@PSA10269</Label>
			<EnumType>NoYes</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>InvoiceNow</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>Amount</ExtendedDataType>
			<Label>@PSA795</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>IsReleased</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>NoYesId</ExtendedDataType>
			<Label>@PSA2816</Label>
			<EnumType>NoYes</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>IsRetained</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>NoYesId</ExtendedDataType>
			<Label>@PSA2816</Label>
			<EnumType>NoYes</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>LineAmount</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>Amount</ExtendedDataType>
			<Label>@SYS10500</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>LineNum</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>LineNum</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>OriginalBudget</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>AmountCur</ExtendedDataType>
			<Label>@SYS103933</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>Package</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<Label>@PSA10073</Label>
			<EnumType>NoYes</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>PartOfInterdependences</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<Label>@PSA10272</Label>
			<EnumType>NoYes</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>PercentInvoiceNow</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>Percent</ExtendedDataType>
			<Label>@PSA1046</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>PreBilledAmount</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>AmountCur</ExtendedDataType>
			<Label>@PSA11019</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ProjId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjId</ExtendedDataType>
			<Mandatory>Yes</Mandatory>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ProjIdCapRoot</Name>
			<AllowEdit>No</AllowEdit>
			<AllowEditOnCreate>No</AllowEditOnCreate>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ProjInvoiceProjId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjInvoiceProjId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>Qty</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjQty</ExtendedDataType>
			<Label>@PSA986</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt64">
			<Name>RefRecId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>RefRecId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt64">
			<Name>RefRecIdCat</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>RefRecId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt64">
			<Name>RefRecIdTrans</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>RefRecId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt">
			<Name>RefTableId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>RefTableId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>RefTransId</Name>
			<AllowEdit>No</AllowEdit>
			<AllowEditOnCreate>No</AllowEditOnCreate>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjTransIdBase</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt64">
			<Name>Resource</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ResourceRecId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>RevisedBudget</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>AmountCur</ExtendedDataType>
			<Label>@SYS133170</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>SalesPrice</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>SalesPrice</ExtendedDataType>
			<Label>@SYS6928</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>Selected</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>NoYesId</ExtendedDataType>
			<Label>@SYS24159</Label>
			<EnumType>NoYes</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ServiceEventGroup_IN</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<CountryRegionCodes>IN</CountryRegionCodes>
			<ExtendedDataType>ServiceEventGroup_IN</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>Task</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<IsObsolete>Yes</IsObsolete>
			<EnumType>PSAProjTask</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldInt64">
			<Name>TaxInformation_IN</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>RefRecId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>TotalBudget</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>AmountCur</ExtendedDataType>
			<Label>@SYS103934</Label>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>TransactionOrigin</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjTransactionOrigin</ExtendedDataType>
			<EnumType>ProjOrigin</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldDate">
			<Name>TransDate</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjTransDate</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>TransStatus</Name>
			<AllowEdit>No</AllowEdit>
			<AllowEditOnCreate>No</AllowEditOnCreate>
			<AssetClassification>System Metadata</AssetClassification>
			<EnumType>ProjTransStatus</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>TransType</Name>
			<AllowEdit>No</AllowEdit>
			<AllowEditOnCreate>No</AllowEditOnCreate>
			<AssetClassification>System Metadata</AssetClassification>
			<EnumType>ProjTransType</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>Txt</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>Description255</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldReal">
			<Name>FixedExchRate</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>SalesFixedExchRate</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>FundingSourceId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjFundingSourceId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldEnum">
			<Name>FundingType</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<EnumType>ProjFundingType</EnumType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>LinePropertyId</Name>
			<AssetClassification>System Metadata</AssetClassification>
			<ExtendedDataType>ProjLinePropertyId</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>SalesUnit</Name>
			<ExtendedDataType>SalesUnit</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>TaxGroupId</Name>
			<ExtendedDataType>ProjTaxGroup</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>TaxItemGroupId</Name>
			<ExtendedDataType>ProjTaxItemGroup</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ResourceId</Name>
			<ExtendedDataType>ResResourceID</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>ResourceName</Name>
			<ExtendedDataType>ResResourceName</ExtendedDataType>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>Purpose</Name>
			<ExtendedDataType>smmActivityPurpose</ExtendedDataType>
		</AxTableField>
	</Fields>
	<FullTextIndexes />
	<Indexes>
		<AxTableIndex>
			<Name>CategoryIdx</Name>
			<AllowDuplicates>Yes</AllowDuplicates>
			<Fields>
				<AxTableIndexField>
					<DataField>CategoryId</DataField>
				</AxTableIndexField>
			</Fields>
		</AxTableIndex>
		<AxTableIndex>
			<Name>SortIdx</Name>
			<AllowDuplicates>Yes</AllowDuplicates>
			<Fields>
				<AxTableIndexField>
					<DataField>ProjId</DataField>
				</AxTableIndexField>
				<AxTableIndexField>
					<DataField>TransDate</DataField>
				</AxTableIndexField>
			</Fields>
		</AxTableIndex>
	</Indexes>
	<Mappings />
	<Relations>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>Currency</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>Currency</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>CurrencyCode</Name>
					<SourceEDT>CurrencyCode</SourceEDT>
					<Field>CurrencyCode</Field>
					<RelatedField>CurrencyCode</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>CurrencyCodeIdx</Index>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>CustTable</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>CustTable</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>CustAccount</Name>
					<SourceEDT>CustAccount</SourceEDT>
					<Field>CustAccount</Field>
					<RelatedField>AccountNum</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>AccountIdx</Index>
		</AxTableRelation>
		<AxTableRelation>
			<Name>ForecastModel</Name>
			<Cardinality>ZeroMore</Cardinality>
			<RelatedTable>ForecastModel</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>ForecastModelId</Name>
					<SourceEDT>ForecastModelId</SourceEDT>
					<Field>ForecastModelId</Field>
					<RelatedField>ModelId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>ProjCategory</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>ProjCategory</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>CategoryId</Name>
					<SourceEDT>ProjCategoryId</SourceEDT>
					<Field>CategoryId</Field>
					<RelatedField>CategoryId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>CategoryIdx</Index>
		</AxTableRelation>
		<AxTableRelation>
			<Name>ProjEmplTrans</Name>
			<Cardinality>ZeroMore</Cardinality>
			<RelatedTable>ProjEmplTrans</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>RefTableId</Name>
					<Field>RefTableId</Field>
					<RelatedField>TableId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>ProjInvoiceTable</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>ProjInvoiceTable</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>ProjInvoiceProjId</Name>
					<SourceEDT>ProjInvoiceProjId</SourceEDT>
					<Field>ProjInvoiceProjId</Field>
					<RelatedField>ProjInvoiceProjId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>ProjInvoiceIdx</Index>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>ProjTable</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>ProjTable</RelatedTable>
			<RelatedTableCardinality>ExactlyOne</RelatedTableCardinality>
			<RelatedTableRole>ProjId_ProjId</RelatedTableRole>
			<RelationshipType>Association</RelationshipType>
			<Role>ProjId</Role>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>ProjId</Name>
					<SourceEDT>ProjId</SourceEDT>
					<Field>ProjId</Field>
					<RelatedField>ProjId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>ProjectIdx</Index>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>ProjTable1</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>ProjTable</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelatedTableRole>ProjIdCapRoot_ProjId</RelatedTableRole>
			<RelationshipType>Association</RelationshipType>
			<Role>ProjIdCapRoot</Role>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>ProjIdCapRoot</Name>
					<SourceEDT>ProjId</SourceEDT>
					<Field>ProjIdCapRoot</Field>
					<RelatedField>ProjId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>ProjectIdx</Index>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>PSAContractLineItems</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>PSAContractLineItems</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>ContractLineNum</Name>
					<SourceEDT>PSAContractLineNum</SourceEDT>
					<Field>ContractLineNum</Field>
					<RelatedField>ContractLineNum</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>ContractLineNumIdx</Index>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>PSAIndirectComponent</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>PSAIndirectComponent</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>IndirectComponent</Name>
					<SourceEDT>PSAIndirectComponentId</SourceEDT>
					<Field>IndirectComponent</Field>
					<RelatedField>ComponentId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>ComponentIdIdx</Index>
		</AxTableRelation>
		<AxTableRelation>
			<Name>PSAIndirectComponentTrans</Name>
			<Cardinality>ZeroMore</Cardinality>
			<RelatedTable>PSAIndirectComponentTrans</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>RefRecIdTrans</Name>
					<Field>RefRecIdTrans</Field>
					<RelatedField>RecId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation>
			<Name>PSATmpProjProposalSummary</Name>
			<RelatedTable>PSATmpProjProposalSummary</RelatedTable>
			<RelationshipType>Link</RelationshipType>
			<Validate>No</Validate>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>RefRecIdCat</Name>
					<Field>RefRecIdCat</Field>
					<RelatedField>RecId</RelatedField>
				</AxTableRelationConstraint>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>RefRecId</Name>
					<Field>RefRecId</Field>
					<RelatedField>RecId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation>
			<Name>Resource</Name>
			<Cardinality>ZeroMore</Cardinality>
			<RelatedTable>ResourceView</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>Resource</Name>
					<Field>Resource</Field>
					<RelatedField>RecId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>smmActivities</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>smmActivities</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>ActivityNumber</Name>
					<SourceEDT>ProjActivityNumber</SourceEDT>
					<Field>ActivityNumber</Field>
					<RelatedField>ActivityNumber</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>ActivityNumberIdx</Index>
		</AxTableRelation>
		<AxTableRelation xmlns=""
			i:type="AxTableRelationForeignKey">
			<Name>TaxInformation_IN</Name>
			<Cardinality>ZeroMore</Cardinality>
			<RelatedTable>TaxInformation_IN</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>TaxInformation_IN</Name>
					<Field>TaxInformation_IN</Field>
					<RelatedField>RecId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
			<Index>RecId</Index>
		</AxTableRelation>
		<AxTableRelation>
			<Name>WrkCtrTable</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>WrkCtrTable</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelatedTableRole>WrkCtrTable</RelatedTableRole>
			<RelationshipType>Association</RelationshipType>
			<Role>PSATmpProjProposalTrans</Role>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintRelatedFixed">
					<Name>IsIndividualResource</Name>
					<SourceEDT>PSAWrkCtrId</SourceEDT>
					<RelatedField>IsIndividualResource</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation>
			<Name>ProjFundingSource</Name>
			<Cardinality>ZeroMore</Cardinality>
			<RelatedTable>ProjFundingSource</RelatedTable>
			<RelatedTableCardinality>ZeroOne</RelatedTableCardinality>
			<RelatedTableRole>ProjFundingSource</RelatedTableRole>
			<RelationshipType>Association</RelationshipType>
			<Role>ProjFundingSource_PSATmpProjProposalTrans</Role>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>FundingSourceRefId</Name>
					<Field>FundingSourceRefId</Field>
					<RelatedField>RecId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation>
			<Name>ProjLineProperty</Name>
			<Cardinality>ZeroMore</Cardinality>
			<EDTRelation>Yes</EDTRelation>
			<RelatedTable>ProjLineProperty</RelatedTable>
			<RelatedTableCardinality>ExactlyOne</RelatedTableCardinality>
			<RelationshipType>Association</RelationshipType>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>LinePropertyId</Name>
					<SourceEDT>ProjLinePropertyId</SourceEDT>
					<Field>LinePropertyId</Field>
					<RelatedField>LinePropertyId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
		<AxTableRelation>
			<Name>DefaultDimension</Name>
			<RelatedTable>DimensionAttributeValueSet</RelatedTable>
			<Constraints>
				<AxTableRelationConstraint xmlns=""
					i:type="AxTableRelationConstraintField">
					<Name>DefaultDimension</Name>
					<Field>DefaultDimension</Field>
					<RelatedField>RecId</RelatedField>
				</AxTableRelationConstraint>
			</Constraints>
		</AxTableRelation>
	</Relations>
	<StateMachines />
</AxTable>